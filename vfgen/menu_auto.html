<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
<head>
<title>VFGEN &sect; &nbsp; AUTO</title>
<meta http-equiv="content-type" content="text/html;charset=iso-8859-1" />

<script type="text/javascript" src="MathJax/MathJax.js?config=TeX-AMS_HTML-full"></script>
<link rel="stylesheet" href="menulayout.css" type="text/css" />
<link rel="stylesheet" href="menucontent.css" type="text/css" />
</head>
<body>
<div id="menu-side">
    <img src="images/VFGENbrown.png" alt="VFGEN">
    <ul id="menu-side-nav">
            <li><a href="index.html">Home</a></li>
            <li><a href="menu_download.html">Download</a></li>
            <li><a href="menu_support.html">Support</a></li>
            <li><a href="menu_guide.html">User's Guide</a></li>
            <li><a href="menu_fileformat.html">&sect; &nbsp; Vector Field File</a></li>
            <li><a href="menu_adolc.html">&sect; &nbsp; ADOL-C</a></li>
            <li class="strong"><a href="menu_auto.html">&sect; &nbsp; AUTO</a></li>
            <li><a href="menu_check.html">&sect; &nbsp; Check</a></li>
            <li><a href="menu_cvode.html">&sect; &nbsp; CVODE</a></li>
            <li><a href="menu_dde23.html">&sect; &nbsp; DDE23</a></li>
            <li><a href="menu_ddebiftool.html">&sect; &nbsp; DDE-BIFTOOL</a></li>
            <li><a href="menu_dde_solver.html">&sect; &nbsp; DDE_SOLVER</a></li>
            <li><a href="menu_delay2ode.html">&sect; &nbsp; Delay2ODE</a></li>
            <li><a href="menu_dstool.html">&sect; &nbsp; DSTool</a></li>
            <li><a href="menu_evf.html">&sect; &nbsp; EVF</a></li>
            <li><a href="menu_gsl.html">&sect; &nbsp; GSL</a></li>
            <li><a href="menu_help.html">&sect; &nbsp; Help</a></li>
            <li><a href="menu_javascript.html">&sect; &nbsp; Javascript</a></li>
            <li><a href="menu_latex.html">&sect; &nbsp; LaTeX</a></li>
            <li><a href="menu_lsoda.html">&sect; &nbsp; LSODA</a></li>
            <li><a href="menu_matcont.html">&sect; &nbsp; MATCONT</a></li>
            <li><a href="menu_matlab.html">&sect; &nbsp; MATLAB</a></li>
            <li><a href="menu_octave.html">&sect; &nbsp; Octave</a></li>
            <li><a href="menu_pddecont.html">&sect; &nbsp; PDDE-CONT</a></li>
            <li><a href="menu_pydstool.html">&sect; &nbsp; PyDSTool</a></li>
            <li><a href="menu_pygsl.html">&sect; &nbsp; PyGSL</a></li>
            <li><a href="menu_r.html">&sect; &nbsp; R</a></li>
            <li><a href="menu_radau5.html">&sect; &nbsp; RADAU5</a></li>
            <li><a href="menu_scilab.html">&sect; &nbsp; Scilab</a></li>
            <li><a href="menu_scipy.html">&sect; &nbsp; SciPy</a></li>
            <li><a href="menu_taylor.html">&sect; &nbsp; Taylor</a></li>
            <li><a href="menu_xpp.html">&sect; &nbsp; XPP</a></li>
    </ul>
</div>
<div id="menu-page-content">
<!-- * * * Contents of content_auto.html * * * -->
<h2>AUTO</h2>
<p>
AUTO is a software package for
numerical continuation.  The AUTO web page at Concordia University is
<a href="http://indy.cs.concordia.ca/auto/">http://indy.cs.concordia.ca/auto/</a>.
</p>
<p>
The newest version of AUTO is AUTO07p.  The previous version was AUTO2000.
The examples presented here were run with AUTO07p.
</p>
<h3>The VFGEN AUTO Command</h3>
<p>
A C file that can be used by AUTO is created by the command
<br />
<div class="mypre">$ vfgen auto vector_field_file.vf</div>
<p>
The name of the C file will be <b>[name]_avf.c</b>, where
[name] is the name of the vector field given in the vector field file. 
Only the AUTO function called "func" will be complete.
A "stpnt" function will created to serve as a template.
The <b>DefaultInitialConditions</b> of the variables will be
used for the values in the "stpnt" function;
the file must be edited by hand to define an actual known solution.
The remaining functions will be stubs that do nothing but return 0.
</p>
<p>
Any user functions defined in the vector field file are ignored
in AUTO command.
</p>
<h4>Options</h4>
<table class="options">
<tr>
<td><b>lang</b></td>
<td>
By default, C code is generated by the VFGEN <b>auto</b> command.
If the option <b>lang=fortran</b> is given, FORTRAN code is generated,
for AUTO07p.
The name of the file containing the code is <b>[name]_avf.f</b>.
<br />
<i>Default</i>: <b>lang=c</b>
</td>
</tr>
</table>
<h4>Example 1</h4>
<p>
We consider this variation of the van der Pol equation:
<center>
<table class="eqnarray">
<tr>
<td>&epsilon;<i>x'</i></td><td>=</td>
  <td><i>y+x-x<sup>3</sup>/3</i></td>
</tr>
<tr>
<td>&nbsp;<i>y'</i></td><td>=</td>
  <td><i>a-x</i></td>
</tr>
</table>
</center>
The vector field file is <a href="example_vf/vanderpola.vf">vanderpola.vf</a>.
The default value of &epsilon; specified in the file
is &epsilon;=10<sup>-2</sup>.
</p>
<p>
The file created by
<div class="mypre">$ vfgen auto vanderpola.vf</div>
is <a href="example_auto/vanderpola_avf.c">vanderpola_avf.c</a>.
A "constants" file (created by hand)
is <a href="example_auto/c.vanderpola_avf">c.vanderpola_avf</a>.
</p>
<p>
The AUTO script <a href="example_auto/vanderpola.auto">vanderpola.auto</a>
first does continuation in <i>a</i> of the equilibrium that is
(0,0) when <i>a</i> = 0. (We don't really need to use AUTO for this, 
since the formula for the equilibrium is simply <i>x = a</i>,
<i>y = -a+a<sup>3</sup>/3</i>.)
There is a Hopf bifurcation when <i>a = 1</i>; the script computes
the family of periodic orbits that arises from the Hopf point.
</p>
<p>
Here are plots (in the <i>(x, y)</i> plane) of the some of the
periodic orbits computed by AUTO.
<center>
<img src="example_auto/vanderpola_canards.png" alt="Family of periodic orbits" />
</center>
(This plot was created by the AUTO Python script
<a href="example_auto/vanderpola_plotpos.auto">vanderpola_plotpos.auto</a>.)
Those familiar with the van der Pol equation will recognize this family as the
<a href="http://www.scholarpedia.org/article/Canards">canard</a> solutions.
</p>
<h4>Using lang=fortran</h4>
<p>
The newest version of AUTO is AUTO07p.  This version of AUTO allows the equations
file to be written in either C or FORTRAN.  VFGEN can generate code for either
case.
</p>
<p>
The file created by
<div class="mypre">$ vfgen auto:lang=fortran vanderpola.vf</div>
is <a href="example_auto/fortran/vanderpola_avf.f">vanderpola_avf.f</a>.
The AUTO Python script <a href="example_auto/fortran/vanderpola.auto">vanderpola.auto</a>
and the constants file
<a href="example_auto/fortran/c.vanderpola_avf">c.vanderpola_avf</a>
can be used to compute the family of periodic orbits using the FORTRAN version
of the equations file.
</p>
<h4>Example 2</h4>
<p>
In this example we first use VFGEN to convert the
Mackey-Glass delay equation into
a system of ordinary differential equations,
and then use AUTO to find some of the
bifurcations of the system.
(See the <a href="menu_dde23.html">DDE23 command</a> or the
<a href="menu_dde_solver.html">DDE_SOLVER command</a> for examples in which
the Mackey-Glass equation is solved with a
differential delay equation solver.)
</p>
<p>
We use the version of the Mackey-Glass equations defined in this file:
<a href="example_auto/mg.vf">mg.vf</a>.  The <b>DefaultInitialCondition</b>
and <b>DefaultHistory</b> of the state variable <i>x</i> are both set to 1,
because in the AUTO command, the <b>DefaultInitialCondition</b> is used for
the default values of the STPNT function, and in the Mackey-Glass equation,
<i>x</i>=1 is an equilibrium solution.
</p>
<p>
First, we use VFGEN to approximate the delay equation as a system of ordinary
differential equations:
<div class="mypre">$ vfgen delay2ode:N=20,p=2 mg.vf > mg_2ode.vf</div>
This creates
<a href="example_auto/mg_2ode.vf">mg_2ode.vf</a>, which defines a 41 dimensional
system of ODEs.
</p>
<p>
Next, we use VFGEN to create an AUTO C file for this system:
<div class="mypre">$ vfgen auto mg_2ode.vf</div>
This creates the file <a href="example_auto/mg_2ode_avf.c">mg_2ode_avf.c</a>
</p>
<p>
We also need an AUTO constants file:
<a href="example_auto/c.mg_2ode_avf">c.mg_2ode_avf</a>. (This was created by hand.)
</p>
<p>
We use an AUTO script,
<a href="example_auto/mg.auto">mg.auto</a>,
to compute several bifurcation curves, in which
the bifurcation parameter is the delay &tau;.
The script is executed with the <span class="tt">auto</span> command:
<div class="mypre">$ auto mg.auto</div>
</p>
<p>
AUTO finds a Hopf bifurcation near &tau;=4.703, and
a sequence of period doubling bifurcations
at &tau;=13.05, &tau;=15.78, and &tau;=16.31.
Presumably, this is the beginning of a period doubling cascade to chaos.
</p>
<p>
Here is a plot of the bifurcation diagram, created by the Python script
<a href="example_auto/mg_bif_plot.py">mg_bif_plot.py</a>.
<center>
<img src="example_auto/mg_bif.png">
</center>
The horizontal axis is &tau;, and the vertical axis is the maximum
<i>x</i> value of the periodic orbit.
<!-- * * * End of content_auto.html * * * -->
</div>
<div id="menu-footer">
Copyright &copy; 2005-2014 <a href="http://www.warrenweckesser.net/">Warren Weckesser</a>
</div>
</body>
</html>
