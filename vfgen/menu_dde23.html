<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
<head>
<title>VFGEN &sect; &nbsp; DDE23</title>
<meta http-equiv="content-type" content="text/html;charset=iso-8859-1" />

<script type="text/javascript" src="MathJax/MathJax.js?config=TeX-AMS_HTML-full"></script>
<link rel="stylesheet" href="menulayout.css" type="text/css" />
<link rel="stylesheet" href="menucontent.css" type="text/css" />
</head>
<body>
<div id="menu-side">
    <img src="images/VFGENbrown.png" alt="VFGEN">
    <ul id="menu-side-nav">
            <li><a href="index.html">Home</a></li>
            <li><a href="menu_download.html">Download</a></li>
            <li><a href="menu_support.html">Support</a></li>
            <li><a href="menu_guide.html">User's Guide</a></li>
            <li><a href="menu_fileformat.html">&sect; &nbsp; Vector Field File</a></li>
            <li><a href="menu_adolc.html">&sect; &nbsp; ADOL-C</a></li>
            <li><a href="menu_auto.html">&sect; &nbsp; AUTO</a></li>
            <li><a href="menu_check.html">&sect; &nbsp; Check</a></li>
            <li><a href="menu_cvode.html">&sect; &nbsp; CVODE</a></li>
            <li class="strong"><a href="menu_dde23.html">&sect; &nbsp; DDE23</a></li>
            <li><a href="menu_ddebiftool.html">&sect; &nbsp; DDE-BIFTOOL</a></li>
            <li><a href="menu_dde_solver.html">&sect; &nbsp; DDE_SOLVER</a></li>
            <li><a href="menu_delay2ode.html">&sect; &nbsp; Delay2ODE</a></li>
            <li><a href="menu_dstool.html">&sect; &nbsp; DSTool</a></li>
            <li><a href="menu_evf.html">&sect; &nbsp; EVF</a></li>
            <li><a href="menu_gsl.html">&sect; &nbsp; GSL</a></li>
            <li><a href="menu_help.html">&sect; &nbsp; Help</a></li>
            <li><a href="menu_javascript.html">&sect; &nbsp; Javascript</a></li>
            <li><a href="menu_latex.html">&sect; &nbsp; LaTeX</a></li>
            <li><a href="menu_lsoda.html">&sect; &nbsp; LSODA</a></li>
            <li><a href="menu_matcont.html">&sect; &nbsp; MATCONT</a></li>
            <li><a href="menu_matlab.html">&sect; &nbsp; MATLAB</a></li>
            <li><a href="menu_octave.html">&sect; &nbsp; Octave</a></li>
            <li><a href="menu_pddecont.html">&sect; &nbsp; PDDE-CONT</a></li>
            <li><a href="menu_pydstool.html">&sect; &nbsp; PyDSTool</a></li>
            <li><a href="menu_pygsl.html">&sect; &nbsp; PyGSL</a></li>
            <li><a href="menu_r.html">&sect; &nbsp; R</a></li>
            <li><a href="menu_radau5.html">&sect; &nbsp; RADAU5</a></li>
            <li><a href="menu_scilab.html">&sect; &nbsp; Scilab</a></li>
            <li><a href="menu_scipy.html">&sect; &nbsp; SciPy</a></li>
            <li><a href="menu_taylor.html">&sect; &nbsp; Taylor</a></li>
            <li><a href="menu_xpp.html">&sect; &nbsp; XPP</a></li>
    </ul>
</div>
<div id="menu-page-content">
<!-- * * * Contents of content_dde23.html * * * -->
<h2>DDE23</h2>
<p>
The DDE23 function in <a href="http://www.mathworks.com/">MATLAB</a>
solves differential delay equations with constant lags.
</p>
<h3>The VFGEN DDE23 Command</h3>
<p>
A set of MATLAB files configured to use the DDE23
function are created by the command
<br />
<div class="mypre">$ vfgen dde23 vector_field_file.vf</div>
</p>
<p>
The vector field must have at least one <b>delay</b> expression,
and the delay can not depend on the independent variable or on
any state variables.

<br />

<h4>Options</h4>
<table class="options">
<tr>
<td>
<b>parstyle</b>
</td>
<td>
The method by which parameters are passed to the MATLAB
functions generated by VFGEN is controlled by the
<b>parstyle</b> option.
The default is <b>parstyle=vector</b>, and the alternative parameter style
is specifed with the option <b>parstyle=list</b>.
When <b>parstyle=list</b> is given as
<div class="mypre">$ vfgen dde23:parstyle=list vector_field_file.vf</div>
each parameter is listed explicitly
as an argument of MATLAB functions.
That is, instead of 
<div class="mypre">[name]_dde23(t,x,Zlags,p)</div>
the vector field function will be
<div class="mypre">[name]_dde23(t,x,Zlags,param1,param2,...,paramM)</div>
<br />
<i>Default</i>: <b>parstyle=vector</b>
</td>
</tr>
<tr>
<td>
<b>demo</b>
</td>
<td>
If the option <b>demo=yes</b> is given, the file <b>[name]_dde23_demo.m</b>
is created. This MATLAB file defines the function
<div class="mypre">function [name]_dde23_demo(stoptime)</div>
which when called will solve the equations using DDE23 (with the default
initial conditions and parameters) for the time interval 0 &le; <i>t</i> &le; stoptime.
<br />
<i>Default</i>: <b>demo=no</b>
</td>
</tr>
</table>
<h4>Example 1</h4>
<p>
The Mackey-Glass equation is
<center>
    <i>x</i>'(<i>t</i>) = -<i>b</i>*<i>x</i> +
          <i>a</i>*<i>x</i>(<i>t</i>-&tau;)/(1+<i>x</i>(<i>t</i>-&tau;)<sup>10</sup>)
</center>
</p>
<p>
Here is the Mackey-Glass vector field file: <a href="example_vf/MackeyGlass.vf">MackeyGlass.vf</a>.
<br>
The files created by
<div class="mypre">$ vfgen dde23:demo=yes MackeyGlass.vf</div>
<br>
are
<ul>
<li><a href="example_dde23/MackeyGlass_dde23.m">MackeyGlass_dde23.m</a>
<li><a href="example_dde23/MackeyGlass_dde23_demo.m">MackeyGlass_dde23_demo.m</a>
</ul>
<p>
Here is the plot generated by the MATLAB command <b>MackeyGlass_dde23_demo(500)</b>:
<br />
<center>
<img src="example_dde23/MackeyGlass_dde23_demo.png" alt="Plot of x(t)">
</center>
</p>
<h4>Example 2</h4>
<p>
The SIR delay equations are
<center>
<table class="eqnarray">
<tr>
<td><i>S'(t)</i> </td><td>=</td><td> <i>-&alpha; S I</i></td>
</tr>
<tr>
<td><i>I'(t)</i> </td><td>=</td><td> <i>&alpha; (S I - S(t-&tau;) I(t-&tau;)) </i></td>
</tr>
<tr>
<td><i>R'(t)</i> </td><td>=</td><td> <i>&alpha; S(t-&tau;) I(t-&tau;) </i></td>
</tr>
</table>
</center>
</p>
<p>
These equations are a simple model of the spread of a disease in a well-mixed population
in which each individual is infectious for <i>exactly</i> &tau; time units.
</p>
<p>
The file <a href="example_vf/SIRdelay.vf">SIRdelay.vf</a> is a vector field file for this system.
</p>
<p>
We create a MATLAB function that may be used with the DDE23 library with the command
<div class="mypre">$ vfgen dde23 SIRdelay.vf</div>
The file created by this command is
<a href="example_dde23/SIRdelay_dde23.m">SIRdelay_dde23.m</a>.
</p>
<p>
The file <a href="example_dde23/SIRdelay_dde23_solver.m">SIRdelay_dde23_solver.m</a>
was written to use the DDE23 function generated by VFGEN to solve these equations.
</p>
Here is the plot generated by the command
<b>SIRdelay_dde23_solver(50)</b>:
<p>
<center>
<img src="example_dde23/SIRdelay_dde23_solver.png">
</center>
<br />
Here is a detail of the above plot.  The discontinuity at <i>t</i> = 4 (when the initial
cohort of infectives all recover simultaneously) was handled explicitly
in the MATLAB code.
<center>
<img src="example_dde23/SIRdelay_dde23_solver_detail.png">
</center>
</p>
<!-- * * * End of content_dde23.html * * * -->
</div>
<div id="menu-footer">
Copyright &copy; 2005-2014 <a href="http://www.warrenweckesser.net/">Warren Weckesser</a>
</div>
</body>
</html>
